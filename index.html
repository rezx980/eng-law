<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English Law Lessons - 2nd Year Licence Tests</title>
    <style>
        /* Professional Styling */
        :root {
            --primary-color: #1a237e;
            --secondary-color: #3949ab;
            --accent-color: #ff4081;
            --success-color: #4caf50;
            --warning-color: #ff9800;
            --danger-color: #f44336;
            --light-bg: #f8f9fa;
            --card-bg: #ffffff;
            --text-dark: #333333;
            --text-light: #666666;
            --border-color: #e0e0e0;
            --shadow-light: 0 4px 12px rgba(0, 0, 0, 0.1);
            --shadow-medium: 0 6px 20px rgba(0, 0, 0, 0.15);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text-dark);
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: var(--card-bg);
            border-radius: 15px;
            box-shadow: var(--shadow-medium);
            overflow: hidden;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 30px;
            text-align: center;
            border-bottom: 5px solid var(--accent-color);
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 10px;
        }

        .creator-info {
            font-size: 1rem;
            margin-top: 15px;
        }

        .instagram-link {
            color: var(--accent-color);
            text-decoration: none;
            font-weight: 600;
            transition: color 0.3s;
        }

        .instagram-link:hover {
            color: #ff79b0;
            text-decoration: underline;
        }

        /* Test Progress */
        .test-progress {
            padding: 20px;
            background: var(--light-bg);
            border-bottom: 2px solid var(--border-color);
        }

        .progress-bar-container {
            width: 100%;
            height: 10px;
            background: var(--border-color);
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-color), var(--secondary-color));
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 5px;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--primary-color);
        }

        /* Test Content */
        .test-content {
            padding: 30px;
            display: none;
        }

        .test-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .test-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid var(--border-color);
        }

        .test-title {
            font-size: 2rem;
            color: var(--primary-color);
            font-weight: 700;
            margin-bottom: 10px;
        }

        .test-subtitle {
            font-size: 1.2rem;
            color: var(--secondary-color);
            font-weight: 500;
        }

        /* Questions */
        .question-container {
            margin-bottom: 30px;
        }

        .question-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: var(--shadow-light);
            border-left: 5px solid var(--secondary-color);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .question-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-medium);
        }

        .question-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background: var(--accent-color);
            color: white;
            border-radius: 50%;
            font-weight: 700;
            margin-right: 15px;
            font-size: 1.2rem;
        }

        .question-text {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 25px;
            line-height: 1.6;
        }

        .arabic-text {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 1.4rem;
            color: #2c3e50;
            margin: 10px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border-right: 4px solid var(--accent-color);
            text-align: right;
            direction: rtl;
        }

        /* Multiple Choice */
        .options-container {
            margin-left: 20px;
        }

        .option {
            padding: 16px;
            margin: 12px 0;
            background: var(--light-bg);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            border: 2px solid transparent;
            font-size: 1.1rem;
        }

        .option:hover {
            background: #e8eaf6;
            border-color: var(--secondary-color);
        }

        .option.selected {
            background: #e3f2fd;
            border-color: var(--secondary-color);
            font-weight: 600;
        }

        .option.correct {
            background: #e8f5e9;
            border-color: var(--success-color);
            color: var(--success-color);
            font-weight: 600;
        }

        /* True/False */
        .true-false-container {
            display: flex;
            gap: 20px;
            margin-top: 20px;
        }

        .tf-button {
            flex: 1;
            padding: 18px;
            border: 2px solid var(--secondary-color);
            border-radius: 8px;
            background: white;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }

        .tf-button.true {
            color: var(--success-color);
        }

        .tf-button.false {
            color: var(--danger-color);
        }

        .tf-button.selected {
            background: var(--secondary-color);
            color: white;
        }

        .tf-button.correct {
            background: #e8f5e9;
            border-color: var(--success-color);
            color: var(--success-color);
            font-weight: 600;
        }

        /* Fill in Blank */
        .fill-blank-container {
            margin-top: 20px;
        }

        .blank-input {
            width: 100%;
            max-width: 500px;
            padding: 16px;
            border: 2px solid var(--secondary-color);
            border-radius: 8px;
            font-size: 1.2rem;
            margin-top: 10px;
            transition: all 0.3s;
        }

        .blank-input:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(255, 64, 129, 0.1);
        }

        .blank-input.correct {
            border-color: var(--success-color);
            background: #e8f5e9;
        }

        .blank-input.incorrect {
            border-color: var(--danger-color);
            background: #ffebee;
        }

        /* Translation */
        .translation-container {
            background: #e3f2fd;
            padding: 25px;
            border-radius: 10px;
            margin-top: 20px;
        }

        .translation-question {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 20px;
            color: var(--primary-color);
        }

        .translation-input {
            width: 100%;
            padding: 16px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            margin-top: 10px;
            font-size: 1.1rem;
            transition: all 0.3s;
        }

        .translation-input:focus {
            border-color: var(--secondary-color);
            outline: none;
        }

        .translation-input.correct {
            border-color: var(--success-color);
            background: #e8f5e9;
        }

        .translation-input.incorrect {
            border-color: var(--danger-color);
            background: #ffebee;
        }

        /* Navigation Buttons */
        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 2px solid var(--border-color);
        }

        .nav-button {
            padding: 16px 32px;
            background: var(--secondary-color);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .nav-button:hover:not(:disabled) {
            background: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: var(--shadow-light);
        }

        .nav-button:disabled {
            background: #cccccc;
            cursor: not-allowed;
            opacity: 0.7;
        }

        .nav-button.next {
            background: var(--success-color);
        }

        .nav-button.next:hover:not(:disabled) {
            background: #388e3c;
        }

        .nav-button.check {
            background: var(--accent-color);
        }

        .nav-button.check:hover:not(:disabled) {
            background: #e91e63;
        }

        /* Test Completion */
        .completion-screen {
            text-align: center;
            padding: 50px;
            display: none;
        }

        .completion-screen.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .completion-icon {
            font-size: 4rem;
            color: var(--success-color);
            margin-bottom: 20px;
        }

        .completion-message {
            font-size: 2rem;
            color: var(--primary-color);
            margin-bottom: 30px;
            font-weight: 700;
        }

        .score-display {
            font-size: 1.8rem;
            color: var(--secondary-color);
            margin-bottom: 40px;
        }

        .final-actions {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }

        .action-button {
            padding: 18px 36px;
            background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.3rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: var(--shadow-medium);
        }

        .action-button:hover {
            transform: scale(1.05);
            box-shadow: var(--shadow-medium);
        }

        .action-button.restart {
            background: linear-gradient(135deg, var(--warning-color), #f57c00);
        }

        .action-button.score {
            background: linear-gradient(135deg, var(--success-color), #2e7d32);
        }

        /* Explanation */
        .explanation {
            margin-top: 25px;
            padding: 20px;
            background: #fff3e0;
            border-radius: 8px;
            border-left: 5px solid var(--warning-color);
            font-size: 1.1rem;
            color: #5d4037;
            display: none;
        }

        .explanation.show {
            display: block;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: 25px;
            color: var(--text-light);
            border-top: 1px solid var(--border-color);
            font-size: 0.95rem;
            margin-top: 40px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .test-title {
                font-size: 1.5rem;
            }
            
            .question-text {
                font-size: 1.2rem;
            }
            
            .arabic-text {
                font-size: 1.2rem;
            }
            
            .navigation-buttons {
                flex-direction: column;
                gap: 15px;
            }
            
            .nav-button {
                width: 100%;
                justify-content: center;
            }
            
            .final-actions {
                flex-direction: column;
                align-items: center;
            }
            
            .action-button {
                width: 100%;
                max-width: 300px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1>English Law Lessons - 2nd Year Licence</h1>
            <div class="subtitle">Professional Test Platform for Law Students</div>
            <div class="creator-info">
                Created by <strong>rezox</strong> in 2025 | 
                Instagram: <a href="https://www.instagram.com/irezoxoff" target="_blank" class="instagram-link">@irezoxoff</a>
            </div>
        </header>

        <!-- Test Progress -->
        <div class="test-progress">
            <div class="progress-bar-container">
                <div class="progress-bar" id="overallProgressBar"></div>
            </div>
            <div class="progress-info">
                <span id="currentTestInfo">Test 1 of 3</span>
                <span id="overallProgress">0% Complete</span>
            </div>
        </div>

        <!-- Test Content -->
        <div id="testsContainer">
            <!-- Test content will be generated here -->
        </div>

        <!-- Test Completion Screen -->
        <div class="completion-screen" id="completionScreen">
            <div class="completion-icon">ðŸŽ“</div>
            <div class="completion-message">All Tests Completed!</div>
            <div class="score-display" id="finalScoreDisplay">Score: 0/0 (0%)</div>
            <div class="score-display" id="finalGrade">Grade: Not Yet Calculated</div>
            <div class="final-actions">
                <button class="action-button restart" onclick="restartTests()">Restart All Tests</button>
                <button class="action-button score" onclick="showDetailedScore()">View Detailed Score</button>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            Â© 2025 English Law Lessons Summary - 2nd Year Licence | All Rights Reserved
        </div>
    </div>

    <script>
        // Professional Test Data Structure
        const tests = [
            {
                id: 1,
                title: "Test 1: Sources of Obligation",
                subtitle: "Basic Concepts and Definitions",
                questions: [
                    {
                        type: "multiple",
                        text: "How many main sources of obligation are recognized in Algerian civil law?",
                        options: ["Three", "Four", "Five", "Six"],
                        correct: 2,
                        explanation: "Algerian civil law recognizes five main sources: Law, Contract, Unilateral Act, Harmful Act, and Quasi-contracts."
                    },
                    {
                        type: "truefalse",
                        text: "Obligations arising from administrative decisions are a traditional source of obligation in civil law.",
                        correct: false,
                        explanation: "The traditional sources are: Law, Contract, Unilateral Act, Harmful Act, Quasi-contracts."
                    },
                    {
                        type: "translation",
                        text: "Translate the following term from English to Arabic:",
                        term: "Quasi-contract",
                        correct: "Ø´Ø¨Ù‡ Ø§Ù„Ø¹Ù‚Ø¯",
                        explanation: "Quasi-contract translates to 'Ø´Ø¨Ù‡ Ø§Ù„Ø¹Ù‚Ø¯' in Arabic."
                    },
                    {
                        type: "fillblank",
                        text: "An obligation arising from one person's enrichment at another's expense without legal cause is classified as a ______.",
                        correct: "quasi-contract",
                        explanation: "Unjust enrichment without legal cause falls under quasi-contracts."
                    },
                    {
                        type: "translation",
                        text: "Translate the following term from Arabic to English:",
                        arabicTerm: "Ø§Ù„Ø¥Ø«Ø±Ø§Ø¡ Ø¨Ù„Ø§ Ø³Ø¨Ø¨",
                        correct: "Unjust enrichment",
                        explanation: "Ø§Ù„Ø¥Ø«Ø±Ø§Ø¡ Ø¨Ù„Ø§ Ø³Ø¨Ø¨ translates to 'Unjust enrichment' in English."
                    }
                ]
            },
            {
                id: 2,
                title: "Test 2: Definition & Elements of Contract",
                subtitle: "Contract Formation and Requirements",
                questions: [
                    {
                        type: "multiple",
                        text: "Which article of the Algerian Civil Code defines the contract?",
                        options: ["Article 53", "Article 54", "Article 55", "Article 56"],
                        correct: 1,
                        explanation: "Article 54 provides the definition of contract in Algerian law."
                    },
                    {
                        type: "truefalse",
                        text: "For a contract to be valid, the consent of only one party is sufficient.",
                        correct: false,
                        explanation: "Mutual consent of at least two parties is required for a valid contract."
                    },
                    {
                        type: "translation",
                        text: "Translate the following term from English to Arabic:",
                        term: "Offer",
                        correct: "Ø¥ÙŠØ¬Ø§Ø¨",
                        explanation: "Offer translates to 'Ø¥ÙŠØ¬Ø§Ø¨' in Arabic."
                    },
                    {
                        type: "fillblank",
                        text: "The essential elements for a valid contract are: ______, ______, ______, and ______.",
                        correct: "consent, capacity, lawful object, lawful cause",
                        explanation: "These four elements must all be present for a contract to be valid."
                    },
                    {
                        type: "translation",
                        text: "Translate the following term from Arabic to English:",
                        arabicTerm: "Ø§Ù„Ù‚Ø¨ÙˆÙ„",
                        correct: "Acceptance",
                        explanation: "Ø§Ù„Ù‚Ø¨ÙˆÙ„ translates to 'Acceptance' in English."
                    }
                ]
            },
            {
                id: 3,
                title: "Test 3: Classification of Contracts",
                subtitle: "Types and Categories of Contracts",
                questions: [
                    {
                        type: "multiple",
                        text: "A contract formed by the simple exchange of consent without formalities is called:",
                        options: ["Formal contract", "Consensual contract", "Real contract", "Signed contract"],
                        correct: 1,
                        explanation: "Consensual contracts require only mutual consent, no formalities."
                    },
                    {
                        type: "truefalse",
                        text: "A contract for the sale of real estate in Algerian law is a consensual contract.",
                        correct: false,
                        explanation: "Real estate sales require formalities (authentic deed), making them formal contracts."
                    },
                    {
                        type: "translation",
                        text: "Translate the following term from English to Arabic:",
                        term: "Unilateral contract",
                        correct: "Ø¹Ù‚Ø¯ Ù…Ù„Ø²Ù… Ù„Ø¬Ø§Ù†Ø¨ ÙˆØ§Ø­Ø¯",
                        explanation: "Unilateral contract translates to 'Ø¹Ù‚Ø¯ Ù…Ù„Ø²Ù… Ù„Ø¬Ø§Ù†Ø¨ ÙˆØ§Ø­Ø¯' in Arabic."
                    },
                    {
                        type: "fillblank",
                        text: "A real contract is only completed by the ______ of the subject matter.",
                        correct: "physical delivery",
                        explanation: "Real contracts require actual delivery of the object."
                    },
                    {
                        type: "translation",
                        text: "Translate the following term from Arabic to English:",
                        arabicTerm: "Ø§Ù„Ø¹Ù‚Ø¯ Ø§Ù„Ù…Ù„Ø²Ù… Ù„Ù„Ø¬Ø§Ù†Ø¨ÙŠÙ†",
                        correct: "Synallagmatic contract",
                        explanation: "Ø§Ù„Ø¹Ù‚Ø¯ Ø§Ù„Ù…Ù„Ø²Ù… Ù„Ù„Ø¬Ø§Ù†Ø¨ÙŠÙ† translates to 'Synallagmatic contract' in English."
                    }
                ]
            }
        ];

        // Application State
        let currentTestIndex = 0;
        let userAnswers = {};
        let testResults = {};
        let totalAnswered = 0;
        let totalQuestions = 0;

        // Initialize application
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        function initializeApp() {
            const testsContainer = document.getElementById('testsContainer');

            // Initialize storage and calculate totals
            tests.forEach(test => {
                userAnswers[test.id] = {};
                testResults[test.id] = { total: test.questions.length, correct: 0 };
                totalQuestions += test.questions.length;
                test.questions.forEach((_, index) => {
                    userAnswers[test.id][index] = null;
                });
            });

            // Create test content
            tests.forEach(test => {
                const testDiv = document.createElement('div');
                testDiv.className = 'test-content';
                testDiv.id = `test-${test.id}`;

                const testHeader = document.createElement('div');
                testHeader.className = 'test-header';
                testHeader.innerHTML = `
                    <div class="test-title">${test.title}</div>
                    <div class="test-subtitle">${test.subtitle}</div>
                `;
                testDiv.appendChild(testHeader);

                // Create questions
                const questionsContainer = document.createElement('div');
                questionsContainer.className = 'question-container';

                test.questions.forEach((question, index) => {
                    const questionCard = document.createElement('div');
                    questionCard.className = 'question-card';
                    questionCard.id = `test-${test.id}-q${index}`;
                    questionCard.dataset.questionIndex = index;

                    const questionNumber = document.createElement('span');
                    questionNumber.className = 'question-number';
                    questionNumber.textContent = index + 1;

                    const questionText = document.createElement('div');
                    questionText.className = 'question-text';
                    questionText.appendChild(questionNumber);
                    
                    // Add question text
                    const textSpan = document.createElement('span');
                    textSpan.textContent = question.text;
                    questionText.appendChild(textSpan);
                    
                    // Add Arabic text if present
                    if (question.arabicTerm) {
                        const arabicDiv = document.createElement('div');
                        arabicDiv.className = 'arabic-text';
                        arabicDiv.textContent = question.arabicTerm;
                        questionText.appendChild(arabicDiv);
                    }
                    
                    // Add term for translation questions
                    if (question.term) {
                        const termDiv = document.createElement('div');
                        termDiv.style.marginTop = '10px';
                        termDiv.style.fontSize = '1.4rem';
                        termDiv.style.fontWeight = '600';
                        termDiv.style.color = 'var(--primary-color)';
                        termDiv.style.padding = '10px';
                        termDiv.style.backgroundColor = '#f0f4ff';
                        termDiv.style.borderRadius = '6px';
                        termDiv.textContent = `"${question.term}"`;
                        questionText.appendChild(termDiv);
                    }

                    questionCard.appendChild(questionText);

                    // Add question type specific content
                    addQuestionContent(test.id, index, question, questionCard);

                    // Explanation placeholder
                    const explanation = document.createElement('div');
                    explanation.className = 'explanation';
                    explanation.id = `explanation-${test.id}-${index}`;
                    questionCard.appendChild(explanation);

                    questionsContainer.appendChild(questionCard);
                });

                testDiv.appendChild(questionsContainer);

                // Navigation buttons for this test
                const navButtons = document.createElement('div');
                navButtons.className = 'navigation-buttons';
                
                const prevButton = document.createElement('button');
                prevButton.className = 'nav-button';
                prevButton.innerHTML = 'â† Previous Test';
                prevButton.onclick = () => navigateToTest(currentTestIndex - 1);
                if (test.id === 1) prevButton.disabled = true;
                
                const checkButton = document.createElement('button');
                checkButton.className = 'nav-button check';
                checkButton.innerHTML = 'âœ“ Check All Answers';
                checkButton.onclick = () => checkAllAnswers(test.id);
                
                const nextButton = document.createElement('button');
                nextButton.className = 'nav-button next';
                nextButton.innerHTML = 'Next Test â†’';
                nextButton.onclick = () => {
                    if (checkAllAnswers(test.id)) {
                        navigateToTest(currentTestIndex + 1);
                    }
                };
                if (test.id === tests.length) {
                    nextButton.innerHTML = 'Finish Tests â†’';
                    nextButton.onclick = () => {
                        if (checkAllAnswers(test.id)) {
                            completeAllTests();
                        }
                    };
                }

                navButtons.appendChild(prevButton);
                navButtons.appendChild(checkButton);
                navButtons.appendChild(nextButton);
                testDiv.appendChild(navButtons);

                testsContainer.appendChild(testDiv);
            });

            // Show first test
            showTest(0);
            updateProgress();
        }

        function addQuestionContent(testId, questionIndex, question, container) {
            const contentDiv = document.createElement('div');
            
            switch(question.type) {
                case 'multiple':
                    const optionsDiv = document.createElement('div');
                    optionsDiv.className = 'options-container';
                    
                    question.options.forEach((option, optionIndex) => {
                        const optionDiv = document.createElement('div');
                        optionDiv.className = 'option';
                        optionDiv.textContent = option;
                        optionDiv.onclick = function() {
                            selectOption(testId, questionIndex, optionIndex, optionsDiv);
                        };
                        optionsDiv.appendChild(optionDiv);
                    });
                    contentDiv.appendChild(optionsDiv);
                    break;

                case 'truefalse':
                    const tfDiv = document.createElement('div');
                    tfDiv.className = 'true-false-container';
                    
                    const trueBtn = document.createElement('div');
                    trueBtn.className = 'tf-button true';
                    trueBtn.textContent = 'True';
                    trueBtn.onclick = function() {
                        selectTrueFalse(testId, questionIndex, true, tfDiv);
                    };
                    
                    const falseBtn = document.createElement('div');
                    falseBtn.className = 'tf-button false';
                    falseBtn.textContent = 'False';
                    falseBtn.onclick = function() {
                        selectTrueFalse(testId, questionIndex, false, tfDiv);
                    };
                    
                    tfDiv.appendChild(trueBtn);
                    tfDiv.appendChild(falseBtn);
                    contentDiv.appendChild(tfDiv);
                    break;

                case 'fillblank':
                    const fillDiv = document.createElement('div');
                    fillDiv.className = 'fill-blank-container';
                    const input = document.createElement('input');
                    input.type = 'text';
                    input.className = 'blank-input';
                    input.placeholder = 'Type your answer here...';
                    input.oninput = function() {
                        updateFillBlank(testId, questionIndex, this);
                    };
                    fillDiv.appendChild(input);
                    contentDiv.appendChild(fillDiv);
                    break;

                case 'translation':
                    const transDiv = document.createElement('div');
                    transDiv.className = 'translation-container';
                    
                    const transQuestion = document.createElement('div');
                    transQuestion.className = 'translation-question';
                    transQuestion.textContent = question.arabicTerm ? 'Write the English translation:' : 'Write the Arabic translation:';
                    transDiv.appendChild(transQuestion);
                    
                    const transInput = document.createElement('input');
                    transInput.type = 'text';
                    transInput.className = 'translation-input';
                    transInput.placeholder = question.arabicTerm ? 'English translation...' : 'Arabic translation...';
                    transInput.oninput = function() {
                        updateTranslation(testId, questionIndex, this);
                    };
                    transDiv.appendChild(transInput);
                    
                    contentDiv.appendChild(transDiv);
                    break;
            }

            container.appendChild(contentDiv);
        }

        function showTest(testIndex) {
            // Hide all tests
            document.querySelectorAll('.test-content').forEach(test => {
                test.classList.remove('active');
            });
            
            // Show selected test
            document.getElementById(`test-${testIndex + 1}`).classList.add('active');
            
            currentTestIndex = testIndex;
            updateProgress();
        }

        function navigateToTest(testIndex) {
            if (testIndex >= 0 && testIndex < tests.length) {
                showTest(testIndex);
            }
        }

        function updateProgress() {
            // Update answered count
            totalAnswered = 0;
            tests.forEach(test => {
                totalAnswered += Object.values(userAnswers[test.id]).filter(a => a !== null).length;
            });
            
            // Update progress bar
            const progressPercentage = (totalAnswered / totalQuestions) * 100;
            document.getElementById('overallProgressBar').style.width = `${progressPercentage}%`;
            
            // Update progress info
            document.getElementById('currentTestInfo').textContent = `Test ${currentTestIndex + 1} of ${tests.length}`;
            document.getElementById('overallProgress').textContent = `${Math.round(progressPercentage)}% Complete`;
        }

        // Answer handling functions
        function selectOption(testId, questionIndex, optionIndex, container) {
            container.querySelectorAll('.option').forEach(opt => {
                opt.classList.remove('selected');
            });
            container.children[optionIndex].classList.add('selected');
            userAnswers[testId][questionIndex] = optionIndex;
            updateProgress();
        }

        function selectTrueFalse(testId, questionIndex, value, container) {
            container.querySelectorAll('.tf-button').forEach(btn => {
                btn.classList.remove('selected');
            });
            container.children[value ? 0 : 1].classList.add('selected');
            userAnswers[testId][questionIndex] = value;
            updateProgress();
        }

        function updateFillBlank(testId, questionIndex, input) {
            userAnswers[testId][questionIndex] = input.value.trim();
            updateProgress();
        }

        function updateTranslation(testId, questionIndex, input) {
            userAnswers[testId][questionIndex] = input.value.trim();
            updateProgress();
        }

        function checkAnswer(testId, questionIndex) {
            const question = tests[testId - 1].questions[questionIndex];
            const userAnswer = userAnswers[testId][questionIndex];
            const questionElement = document.getElementById(`test-${testId}-q${questionIndex}`);
            const explanation = document.getElementById(`explanation-${testId}-${questionIndex}`);

            // Remove previous markings
            questionElement.querySelectorAll('.option.correct').forEach(el => {
                el.classList.remove('correct');
            });
            questionElement.querySelectorAll('.tf-button.correct').forEach(btn => {
                btn.classList.remove('correct');
            });
            questionElement.querySelectorAll('.blank-input').forEach(input => {
                input.classList.remove('correct', 'incorrect');
            });
            questionElement.querySelectorAll('.translation-input').forEach(input => {
                input.classList.remove('correct', 'incorrect');
            });

            // Check answer based on type
            let isCorrect = false;

            switch(question.type) {
                case 'multiple':
                    if (userAnswer === question.correct) {
                        isCorrect = true;
                        questionElement.querySelectorAll('.option')[question.correct].classList.add('correct');
                    } else if (userAnswer !== null) {
                        questionElement.querySelectorAll('.option')[question.correct].classList.add('correct');
                    }
                    break;

                case 'truefalse':
                    if (userAnswer === question.correct) {
                        isCorrect = true;
                        const btn = question.correct ? 
                            questionElement.querySelector('.tf-button.true') : 
                            questionElement.querySelector('.tf-button.false');
                        btn.classList.add('correct');
                    } else if (userAnswer !== null) {
                        const correctBtn = question.correct ? 
                            questionElement.querySelector('.tf-button.true') : 
                            questionElement.querySelector('.tf-button.false');
                        correctBtn.classList.add('correct');
                    }
                    break;

                case 'fillblank':
                    if (userAnswer && userAnswer.toLowerCase() === question.correct.toLowerCase()) {
                        isCorrect = true;
                        const input = questionElement.querySelector('.blank-input');
                        input.classList.add('correct');
                    } else if (userAnswer) {
                        const input = questionElement.querySelector('.blank-input');
                        input.classList.add('incorrect');
                    }
                    break;

                case 'translation':
                    if (userAnswer && userAnswer.trim().toLowerCase() === question.correct.toLowerCase()) {
                        isCorrect = true;
                        const input = questionElement.querySelector('.translation-input');
                        input.classList.add('correct');
                    } else if (userAnswer) {
                        const input = questionElement.querySelector('.translation-input');
                        input.classList.add('incorrect');
                    }
                    break;
            }

            // Update results
            if (isCorrect && !questionElement.dataset.checked) {
                testResults[testId].correct++;
                questionElement.dataset.checked = 'true';
            }

            // Show explanation
            if (question.explanation) {
                explanation.textContent = `Explanation: ${question.explanation}`;
                explanation.classList.add('show');
            }

            return isCorrect;
        }

        function checkAllAnswers(testId) {
            const test = tests[testId - 1];
            let allChecked = true;
            let allCorrect = true;

            test.questions.forEach((_, index) => {
                if (userAnswers[testId][index] === null) {
                    allChecked = false;
                } else {
                    if (!checkAnswer(testId, index)) {
                        allCorrect = false;
                    }
                }
            });

            if (!allChecked) {
                alert(`Please answer all ${test.questions.length} questions in this test before proceeding.`);
                return false;
            }

            return true;
        }

        function completeAllTests() {
            // Hide all tests
            document.querySelectorAll('.test-content').forEach(test => {
                test.classList.remove('active');
            });
            
            // Show completion screen
            document.getElementById('completionScreen').classList.add('active');
            
            // Calculate and display final score
            let totalCorrect = 0;
            let totalQuestions = 0;
            
            tests.forEach(test => {
                totalQuestions += testResults[test.id].total;
                totalCorrect += testResults[test.id].correct;
            });
            
            const percentage = (totalCorrect / totalQuestions) * 100;
            let grade = '';
            let gradePoints = '';
            
            if (percentage >= 90) {
                grade = 'Excellent';
                gradePoints = '20/20';
            } else if (percentage >= 80) {
                grade = 'Very Good';
                gradePoints = '16-19/20';
            } else if (percentage >= 70) {
                grade = 'Good';
                gradePoints = '14-15/20';
            } else if (percentage >= 60) {
                grade = 'Satisfactory';
                gradePoints = '12-13/20';
            } else {
                grade = 'Needs Review';
                gradePoints = 'Below 12/20';
            }
            
            document.getElementById('finalScoreDisplay').textContent = 
                `Score: ${totalCorrect}/${totalQuestions} (${percentage.toFixed(1)}%)`;
            
            document.getElementById('finalGrade').textContent = 
                `Grade: ${grade} - ${gradePoints}`;
        }

        function showDetailedScore() {
            let detailedScore = "Detailed Results:\n\n";
            
            tests.forEach(test => {
                detailedScore += `${test.title}:\n`;
                detailedScore += `  Correct: ${testResults[test.id].correct}/${testResults[test.id].total}\n`;
                detailedScore += `  Score: ${Math.round((testResults[test.id].correct / testResults[test.id].total) * 100)}%\n\n`;
            });
            
            alert(detailedScore);
        }

        function restartTests() {
            // Reset all data
            currentTestIndex = 0;
            userAnswers = {};
            testResults = {};
            totalAnswered = 0;
            totalQuestions = 0;
            
            // Hide completion screen
            document.getElementById('completionScreen').classList.remove('active');
            
            // Clear the container and reinitialize
            const testsContainer = document.getElementById('testsContainer');
            testsContainer.innerHTML = '';
            
            // Reinitialize the app
            initializeApp();
        }
    </script>
</body>
</html>
